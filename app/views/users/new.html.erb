<div class="form-container">
  <h2>新規会員登録</h2>

  <%= form_with model: @user, local: true, html: { multipart: true }, class: "user-form" do |f| %>

    <!-- 名前 -->
    <div class="field-row">
      <div class="field">
        <%= f.label :last_name, "名字（全角）", class: "field-label" %>
        <%= f.text_field :last_name, placeholder: "飲んだくれ", class: "input-field" %>
      </div>
      <div class="field">
        <%= f.label :first_name, "名前（全角）", class: "field-label" %>
        <%= f.text_field :first_name, placeholder: "太郎", class: "input-field" %>
      </div>
    </div>

    <!-- メール -->
    <div class="field">
      <%= f.label :email, "メールアドレス", class: "field-label" %>
      <%= f.email_field :email, placeholder: "example@sakenomail.com", class: "input-field" %>
    </div>

    <!-- 電話番号 -->
    <div class="field">
      <%= f.label :phone_number, "電話番号（ハイフンなし）", class: "field-label" %>
      <%= f.telephone_field :phone_number, placeholder: "09012345678", class: "input-field" %>
    </div>

    <!-- 生年月日（単独） -->
    <div class="field form-date">
      <%= f.label :birth_date, "生年月日", class: "field-label" %><br>
      <%= f.date_select :birth_date, start_year: Date.today.year - 100, end_year: Date.today.year, use_month_numbers: true %>
    </div>
    
    <!-- ユーザー名（単独） -->
    <div class="field">
      <%= f.label :username, "ユーザー名", class: "field-label" %>
      <%= f.text_field :username, placeholder: "ユーザー名は公表されます", class: "input-field" %>
    </div>

    <!-- プロフィール画像 -->
    <div class="field image-upload">
      <%= f.label :icon, "プロフィール画像", class: "field-label" %><br>
      <%= f.file_field :icon, accept: 'image/*', onchange: "previewIcon(event)" %>
      <%= image_tag(@user.icon.attached? ? url_for(@user.icon) : 'icon.png', id: "icon-preview", class: "profile-preview") %>
    </div>
    

    <!-- プロフィール文 -->
    <div class="field">
      <%= f.label :profile, "プロフィール（任意）", class: "field-label" %>
      <%= f.text_area :profile, placeholder: "どうも！酒飲みです！よろしくお願いします！", class: "input-field profile-text" %>
    </div>

    <!-- パスワード -->
    <div class="field">
      <%= f.label :password, "パスワード（8文字以上）", class: "field-label" %>
      <%= f.password_field :password, class: "input-field" %>
    </div>

    <div class="field">
      <%= f.label :password_confirmation, "確認用パスワード", class: "field-label" %>
      <%= f.password_field :password_confirmation, class: "input-field" %>
    </div>

    <!-- 送信ボタン -->
    <%= f.submit "登録する", class: "submit-btn" %>
  <% end %>
</div>

<!-- プレビューJS -->
<script>
  function previewIcon(event) {
    const input = event.target;
    const preview = document.getElementById('icon-preview');
    if (input.files && input.files[0]) {
      const reader = new FileReader();
      reader.onload = function(e) {
        preview.src = e.target.result;
      }
      reader.readAsDataURL(input.files[0]);
    }
  }
</script>
